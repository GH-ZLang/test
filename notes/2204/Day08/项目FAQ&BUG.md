# 项目中遇到的问题

## 需求变更问题
因为对业务理解不够透彻,表设计就有很多考虑不周的地方,
经常会因为表中字段的迭代,修改项目中的业务代码.

## 表设计问题的权衡
1)范式与反范式的应用?(严格遵循三大范式会影响查询的效率)
2)字段的冗余虽然可以提高查询的效率,但可能会加大数据维护的成本(一致性)
3)宽表设计规范问题?(多少个字段我们设计为宽表)
4)字段类型应用问题?(简单,小类型,大字段要拆出去-Text,Blob)
5)字段约束问题?(主键,外键,唯一,非空,检查-在有些数据库版本中是无效)

## SQL编写及优化问题?
1)SQL的结构(例如小表驱动大表,用具体字段替换"*",避免非必要字段值的返回)
2)SQL索引应用(主键,普通,组合,全文索引,...)
3)事务隔离级别(隔离级别越高性能就越差)

思考:客户端发出一个查询请求,这个请求要从数据库查询数据,但响应数据特别慢?
1)通过Profile,Explain检查是否应用了索引?(设计了也有可能会出现索引失效)
2)假如有排序,检查是索引排序还是filesort?(假如是filesort需要进行优化-例如修改磁盘缓冲区大小)
3)检查mysql可以支持最大连接数?(没有连接了,用户就需要等待)
4)检查应用程序中连接池参数设计是否合理(连接池最大连接数的设计)

## SQL索引失效问题?
1)查询条件是模糊查询并且是以"%"开头.
2)函询条件中应用了函数(例如: where year(hire_date)='1999')
3)查询条件中的条件的顺序与创建的组合索引顺序不一致(不同数据数据库版本优化策略不一样)
4)查询条件中使用了in或not in这样的表达式
5)查询中使用了xxx is null或 xxx is not null表达式.
6)查询条件中使用了隐式类型转换(id是int类型,但是查询时使用的是id='111');

思考: 数据量比较大时,分页查询数据效率比较低,如何解决?
优化sql结构,创建条件查询索引,进行分库分表

## 分库分表的设计问题?
1)不同业务不同数据库(例如订单库,库存库,商品库,....)
2)水平分表(表中数据量特别大,例如超出了500万,可以按时间维度进行水平分表-历史表)
3)垂直分表(有些大字段影响查询的效率,此时可以将大字段进行独立拆分)

## 分库分表后可能会带来什么问题?

1)事务的分布式处理
2)跨库之间的表join问题(可以在业务层多次查询)
3)跨库之间的数据统计问题(多次统计再合并)
4)分布式ID问题(业务层独立生成id)
5).....

## Redis数据的可靠性问题
1)数据持久化(RDB,AOF,混合模式)
2)主从架构+哨兵,集群(至少6节点)

## Redis缓存穿透/击穿/雪崩问题
1)缓存穿透:缓存没有,数据库也没有; (接口校验,缓存null,布隆过滤器)
2)缓存击穿:缓存没有,请求数据库; (热点数据不设置过期时间,使用互斥锁)
3)缓存雪崩:多个缓存击穿;(打散key的过期时间,多级缓存,互斥锁)

## MQ消息丢失问题
1)消息发送方进行消息确认(消息发送到MQ,MQ要返回确认)
2)消息中间件(MQ)要对消息持久化.
3)消息消费方消费消息后要手动确认.

## MQ消息被重复被消费?
进行消息幂等性设计,可以将消费过的消息key存储到redis.

## 服务调用超时?
1)重试
2)熔断

##你了解哪些错误状态码?
1)404 (请求url不正确,对应资源找不到)
2)400 (请求参数个数,格式,类型不正确)
3)405 (请求方式与服务端不匹配)
4)401 (没有认证)
5)403 (没有授权)
6)500 (服务异常)
7)503 (通过网关访问没有找到对应服务)

##遇到哪些异常类型
1)并发异常
2)NPE异常
3)算数异常
4)参数不合法
5)类型转换异常
6)SQL语法异常
7)限流异常
8)内存溢出异常
9)BindingException
10)NoSuchBeanDefinition
11)依赖注入异常
12).................



































